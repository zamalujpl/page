---
import "../../styles.css";
import Navbar from "../../components/Navbar.astro";
import Footer from "../../components/Footer.astro";
import PrintFooter from "../../components/PrintFooter.astro";
import assets from "../../assets.json";

/** Generate static paths for all images in all categories */
export async function getStaticPaths() {
  const paths = [];
  for (const [catKey, cat] of Object.entries(assets)) {
    for (const item of cat.items) {
      paths.push({
        params: { category: catKey, key: item.key },
        props: {
          image: item,
          category: catKey,
          catTitle: cat.title_key ?? catKey,
        },
      });
    }
  }
  return paths;
}

const { category, key } = Astro.props;
const { image, catTitle } = Astro.props;
const title = image.key
  .replace(/_/g, " ")
  .replace(/\b\w/g, (l) => l.toUpperCase());
const year = new Date().getFullYear();
---

<html lang="en">
  <head>
    <title>{title}</title>
    <script src="/js/protection.js" is:inline></script>
  </head>
  <body class="bg-gray-50 min-h-screen flex flex-col">
    <Navbar />
    <main class="flex-1 flex flex-col items-center justify-center">
      <div class="w-full max-w-2xl flex flex-col items-center mt-10">
        <img
          src={`/${image.file}`}
          alt={title}
          id="main-image"
          class="max-w-full max-h-[80vh] mb-6"
        />
        <button
          onclick="window.print()"
          class="no-print btn btn-outline btn-primary btn-sm mb-8"
        >
          Drukuj obrazek
        </button>
        <a
          href={`/${category}/`}
          class="no-print text-blue-600 hover:underline"
        >
          Powr√≥t do kategorii {catTitle}
        </a>
      </div>
    </main>
    <PrintFooter />
    <Footer />
  </body>
</html>
